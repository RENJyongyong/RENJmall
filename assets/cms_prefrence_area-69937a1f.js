import{_ as A,r as D,c as U,a as l,w as q,b as n,E as F,d as j,o as h,e as y,f as K,g as P,h as L,i as M,j as O}from"./index-9741e164.js";import{E as R,a as G,b as H}from"./el-table-column-ec3606f8.js";import{E as J}from"./el-input-number-9855c8cc.js";import{E as s,a as Q}from"./el-select-be570fba.js";import{a as f}from"./index-420bff95.js";import{E as W}from"./index-88838146.js";import{E as V}from"./index-ff6c3d72.js";let C;const g=()=>{C=W.service({lock:!0,text:"加载中...",spinner:"wave"})},_=()=>{C&&C.close()},X=async t=>{g();try{return await f.request({url:"/mall/cms-prefrence-area/one/"+t,method:"get"})}catch(e){throw e}finally{_()}},Y=async t=>{g();try{return await f.request({url:"/mall/cms-prefrence-area/del/"+t,method:"get"})}catch(e){throw e}finally{_()}},Z=async t=>{g();try{return await f.request({url:"/mall/cms-prefrence-area/edit",method:"post",data:t})}catch(e){throw e}finally{_()}},$=async t=>{g();try{return await f.request({url:"/mall/cms-prefrence-area/add",method:"post",data:t})}catch(e){throw e}finally{_()}},ee=async t=>{g();try{return await f.request({url:"/mall/cms-prefrence-area/page",method:"post",data:t})}catch(e){throw e}finally{_()}},I={One:X,Del:Y,Edit:Z,Add:$,Page:ee};const te={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(t=>String(t.name).includes(String(this.searchText))):this.tableData||[]}},methods:{openEditDialog(t){this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),V.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,s.success("修改成功！"),this.editItem={}}).catch(()=>{s.info("修改取消！")})},fetchData(){I.Page(this.json).then(t=>{this.tableData=t.data.data.page.records||t.data.records,console.log(this.tableData),s.success("刷新成功！")}).catch(t=>{s.error("刷新失败，请检查网络！"),console.error("Error fetching data:",t)})},Insert(t){I.Add(t).then(e=>{delete t.isNew,s.success("插入数据成功！")}).catch(e=>{s.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){I.Edit(t).then(e=>{console.log("修改保存成功:",e.data),s.success("修改数据成功！")}).catch(e=>{s.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(t){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.Del(t.id).then(e=>{const m=this.tableData.findIndex(E=>E.id===t.id);m!==-1&&this.tableData.splice(m,1),console.log("删除成功:",e.data),s.success("删除成功！")}).catch(e=>{s.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(t){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(m=>m.id===t.id);e!==-1&&this.tableData.splice(e,1),s.success("删除成功！")}).catch(()=>{s.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){s.success("添加数据ing");const t={id:0,name:"",pic:"",showStatus:0,sort:0,subTitle:"",isNew:!0};this.tableData.push(t);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},le={class:"root"},ae={slot:"footer"};function ne(t,e,m,E,o,i){const p=F,c=H,x=D("Position"),d=L,r=j,T=D("EditPen"),k=D("Delete"),v=R,S=Q,u=M,w=J,z=O,B=G,N=D("CirclePlusFilled");return h(),U("div",le,[l(p,{modelValue:o.searchText,"onUpdate:modelValue":e[0]||(e[0]=a=>o.searchText=a),placeholder:"请输入搜索关键字",clearable:"",onClear:t.clearSearch,onKeyup:q(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),l(v,{data:i.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:n(()=>[l(c,{prop:"id",label:"id"}),l(c,{prop:"name",label:"name"}),l(c,{prop:"pic",label:"pic"}),l(c,{prop:"showStatus",label:"showStatus"}),l(c,{prop:"sort",label:"sort"}),l(c,{prop:"subTitle",label:"subTitle"}),l(c,{width:"150rpx",label:"操作"},{default:n(({row:a})=>[a.isNew?(h(),y(r,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:b=>i.Insert(a)},{default:n(()=>[l(d,null,{default:n(()=>[l(x)]),_:1})]),_:2},1032,["onClick"])):(h(),y(r,{key:1,class:"custom-button",size:"mini",type:"warning",circle:"",onClick:b=>i.Alter(a)},{default:n(()=>[l(d,null,{default:n(()=>[l(x)]),_:1})]),_:2},1032,["onClick"])),l(r,{type:"primary",size:"mini",circle:"",onClick:b=>i.openEditDialog(a)},{default:n(()=>[l(d,null,{default:n(()=>[l(T)]),_:1})]),_:2},1032,["onClick"]),a.isNew?(h(),y(r,{key:2,size:"mini",type:"danger",circle:"",onClick:b=>i.delND(a)},{default:n(()=>[l(d,null,{default:n(()=>[l(k)]),_:1})]),_:2},1032,["onClick"])):(h(),y(r,{key:3,type:"danger",size:"mini",circle:"",onClick:b=>i.Del(a)},{default:n(()=>[l(d,null,{default:n(()=>[l(k)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),l(S,{"current-page":o.currentPage,"page-size":o.pageSize,total:i.filteredtableData.length,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),l(B,{class:"form",modelValue:o.editDialogVisible,"onUpdate:modelValue":e[8]||(e[8]=a=>o.editDialogVisible=a),center:"",onClose:e[9]||(e[9]=a=>o.editDialogVisible=!1)},{default:n(()=>[l(z,null,{default:n(()=>[l(u,{label:"id"},{default:n(()=>[l(p,{modelValue:o.editItem.id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.editItem.id=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"name"},{default:n(()=>[l(p,{modelValue:o.editItem.name,"onUpdate:modelValue":e[2]||(e[2]=a=>o.editItem.name=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"pic"},{default:n(()=>[l(w,{modelValue:o.editItem.pic,"onUpdate:modelValue":e[3]||(e[3]=a=>o.editItem.pic=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"showStatus"},{default:n(()=>[l(w,{modelValue:o.editItem.showStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>o.editItem.showStatus=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"sort"},{default:n(()=>[l(p,{modelValue:o.editItem.sort,"onUpdate:modelValue":e[5]||(e[5]=a=>o.editItem.sort=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"subTitle"},{default:n(()=>[l(p,{modelValue:o.editItem.subTitle,"onUpdate:modelValue":e[6]||(e[6]=a=>o.editItem.subTitle=a)},null,8,["modelValue"])]),_:1})]),_:1}),K("div",ae,[l(r,{onClick:e[7]||(e[7]=a=>o.editDialogVisible=!1)},{default:n(()=>[P("取消")]),_:1}),l(r,{type:"primary",onClick:i.saveEdit},{default:n(()=>[P("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),l(r,{type:"primary",circle:"",size:"large",onClick:i.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:n(()=>[l(d,null,{default:n(()=>[l(N)]),_:1})]),_:1},8,["onClick"])])}const me=A(te,[["render",ne]]);export{me as default};
