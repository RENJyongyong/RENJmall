import{_ as A,r as y,c as D,a as t,w as q,b as a,E as F,d as j,o as m,e as I,f as K,g as x,h as L,i as M,j as O}from"./index-9741e164.js";import{E as R,a as G,b as H}from"./el-table-column-ec3606f8.js";import{E as J}from"./el-input-number-9855c8cc.js";import{E as i,a as Q}from"./el-select-be570fba.js";import{a as f}from"./index-420bff95.js";import{E as W}from"./index-88838146.js";import{_ as X}from"./1-361bf820.js";import{E as C}from"./index-ff6c3d72.js";let k;const h=()=>{k=W.service({lock:!0,text:"加载中...",spinner:"wave"})},_=()=>{k&&k.close()},Y=async l=>{h();try{return await f.request({url:"/mall/pms-product-category/one/"+l,method:"get"})}catch(e){throw e}finally{_()}},Z=async l=>{h();try{return await f.request({url:"/mall/pms-product-category/del/"+l,method:"get"})}catch(e){throw e}finally{_()}},$=async l=>{h();try{return await f.request({url:"/mall/pms-product-category/edit",method:"post",data:l})}catch(e){throw e}finally{_()}},ee=async l=>{h();try{return await f.request({url:"/mall/pms-product-category/add",method:"post",data:l})}catch(e){throw e}finally{_()}},te=async l=>{h();try{return await f.request({url:"/mall/pms-product-category/page",method:"post",data:l})}catch(e){throw e}finally{_()}},V={One:Y,Del:Z,Edit:$,Add:ee,Page:te};const le={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const l=(this.currentPage-1)*this.pageSize,e=l+this.pageSize;return this.filteredtableData.slice(l,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(l=>String(l.name).includes(String(this.searchText))):this.tableData||[]}},methods:{openEditDialog(l){this.editItem={...l},this.editDialogVisible=!0},handlePageChange(l){this.currentPage=l},saveEdit(){console.log(this.editItem),C.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=this.tableData.findIndex(e=>e.id===this.editItem.id);l!==-1?this.tableData.splice(l,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,i.success("修改成功！"),this.editItem={}}).catch(()=>{i.info("修改取消！")})},fetchData(){V.Page(this.json).then(l=>{this.tableData=l.data.data.page.records||l.data.records,console.log(this.tableData),i.success("刷新成功！")}).catch(l=>{i.error("刷新失败，请检查网络！"),console.error("Error fetching data:",l)})},Insert(l){V.Add(l).then(e=>{delete l.isNew,i.success("插入数据成功！")}).catch(e=>{i.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(l){V.Edit(l).then(e=>{console.log("修改保存成功:",e.data),i.success("修改数据成功！")}).catch(e=>{i.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(l){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{V.Del(l.id).then(e=>{const g=this.tableData.findIndex(w=>w.id===l.id);g!==-1&&this.tableData.splice(g,1),console.log("删除成功:",e.data),i.success("删除成功！")}).catch(e=>{i.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(l){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(g=>g.id===l.id);e!==-1&&this.tableData.splice(e,1),i.success("删除成功！")}).catch(()=>{i.error("删除失败！"),console.log("取消删除 API",l)})},addAPI(){i.success("添加数据ing");const l={description:"",icon:"",id:0,keywords:"",level:0,name:"",navStatus:0,parentId:0,productCount:0,productUnit:"",showStatus:0,sort:0,isNew:!0};this.tableData.push(l);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},oe={class:"root"},ne=["src"],ae={key:1,src:X,alt:"图标",width:"30",height:"30"},se={slot:"footer"};function ie(l,e,g,w,n,u){const r=F,s=H,E=y("Position"),p=L,c=j,P=y("EditPen"),v=y("Delete"),S=R,U=Q,d=M,z=J,T=O,N=G,B=y("CirclePlusFilled");return m(),D("div",oe,[t(r,{modelValue:n.searchText,"onUpdate:modelValue":e[0]||(e[0]=o=>n.searchText=o),placeholder:"请输入搜索关键字",clearable:"",onClear:l.clearSearch,onKeyup:q(l.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),t(S,{data:u.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:a(()=>[t(s,{prop:"id",label:"id"}),t(s,{prop:"description",label:"description"}),t(s,{prop:"icon",label:"icon"},{default:a(({row:o})=>[isNaN(Number(o.icon,10))?(m(),D("img",{key:0,src:o.icon,alt:"图标",width:"30",height:"30"},null,8,ne)):(m(),D("img",ae))]),_:1}),t(s,{prop:"keywords",label:"keywords"}),t(s,{prop:"level",label:"level"}),t(s,{prop:"name",label:"name"}),t(s,{prop:"navStatus",label:"navStatus"}),t(s,{prop:"parentId",label:"parentId"}),t(s,{prop:"productCount",label:"productCount"}),t(s,{prop:"productUnit",label:"productUnit"}),t(s,{prop:"showStatus",label:"showStatus"}),t(s,{prop:"sort",label:"sort"}),t(s,{width:"150rpx",label:"操作"},{default:a(({row:o})=>[o.isNew?(m(),I(c,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:b=>u.Insert(o)},{default:a(()=>[t(p,null,{default:a(()=>[t(E)]),_:1})]),_:2},1032,["onClick"])):(m(),I(c,{key:1,class:"custom-button",size:"mini",type:"warning",circle:"",onClick:b=>u.Alter(o)},{default:a(()=>[t(p,null,{default:a(()=>[t(E)]),_:1})]),_:2},1032,["onClick"])),t(c,{type:"primary",size:"mini",circle:"",onClick:b=>u.openEditDialog(o)},{default:a(()=>[t(p,null,{default:a(()=>[t(P)]),_:1})]),_:2},1032,["onClick"]),o.isNew?(m(),I(c,{key:2,size:"mini",type:"danger",circle:"",onClick:b=>u.delND(o)},{default:a(()=>[t(p,null,{default:a(()=>[t(v)]),_:1})]),_:2},1032,["onClick"])):(m(),I(c,{key:3,type:"danger",size:"mini",circle:"",onClick:b=>u.Del(o)},{default:a(()=>[t(p,null,{default:a(()=>[t(v)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),t(U,{"current-page":n.currentPage,"page-size":n.pageSize,total:u.filteredtableData.length,onCurrentChange:u.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),t(N,{class:"form",modelValue:n.editDialogVisible,"onUpdate:modelValue":e[14]||(e[14]=o=>n.editDialogVisible=o),onClose:e[15]||(e[15]=o=>n.editDialogVisible=!1)},{default:a(()=>[t(T,null,{default:a(()=>[t(d,{label:"description"},{default:a(()=>[t(r,{modelValue:n.editItem.description,"onUpdate:modelValue":e[1]||(e[1]=o=>n.editItem.description=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"icon"},{default:a(()=>[t(r,{modelValue:n.editItem.icon,"onUpdate:modelValue":e[2]||(e[2]=o=>n.editItem.icon=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"id"},{default:a(()=>[t(z,{modelValue:n.editItem.id,"onUpdate:modelValue":e[3]||(e[3]=o=>n.editItem.id=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"keywords"},{default:a(()=>[t(r,{modelValue:n.editItem.keywords,"onUpdate:modelValue":e[4]||(e[4]=o=>n.editItem.keywords=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"level"},{default:a(()=>[t(r,{modelValue:n.editItem.level,"onUpdate:modelValue":e[5]||(e[5]=o=>n.editItem.level=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"name"},{default:a(()=>[t(r,{modelValue:n.editItem.name,"onUpdate:modelValue":e[6]||(e[6]=o=>n.editItem.name=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"navStatus"},{default:a(()=>[t(r,{modelValue:n.editItem.navStatus,"onUpdate:modelValue":e[7]||(e[7]=o=>n.editItem.navStatus=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"parentId"},{default:a(()=>[t(r,{modelValue:n.editItem.parentId,"onUpdate:modelValue":e[8]||(e[8]=o=>n.editItem.parentId=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"productCount"},{default:a(()=>[t(r,{modelValue:n.editItem.productCount,"onUpdate:modelValue":e[9]||(e[9]=o=>n.editItem.productCount=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"productUnit"},{default:a(()=>[t(r,{modelValue:n.editItem.productUnit,"onUpdate:modelValue":e[10]||(e[10]=o=>n.editItem.productUnit=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"showStatus"},{default:a(()=>[t(r,{modelValue:n.editItem.showStatus,"onUpdate:modelValue":e[11]||(e[11]=o=>n.editItem.showStatus=o)},null,8,["modelValue"])]),_:1}),t(d,{label:"sort"},{default:a(()=>[t(r,{modelValue:n.editItem.sort,"onUpdate:modelValue":e[12]||(e[12]=o=>n.editItem.sort=o)},null,8,["modelValue"])]),_:1})]),_:1}),K("div",se,[t(c,{onClick:e[13]||(e[13]=o=>n.editDialogVisible=!1)},{default:a(()=>[x("取消")]),_:1}),t(c,{type:"primary",onClick:u.saveEdit},{default:a(()=>[x("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),t(c,{type:"primary",circle:"",size:"large",onClick:u.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:a(()=>[t(p,null,{default:a(()=>[t(B)]),_:1})]),_:1},8,["onClick"])])}const he=A(le,[["render",ie]]);export{he as default};
